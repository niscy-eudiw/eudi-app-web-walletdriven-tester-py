{% extends 'base.html' %} {% block content %}
<div class="row" style="height: 100%">
  <div class="col-lg-12" style="height: 100%">
    <div id="content" class="content-box col-md-11">
      <h1>QTSP Authentication</h1>
      <div class="genericErrors" id="genericErrorsDesc"></div>

      <a
        class="btn custom-btn"
        id="fetchButton"
        onclick="serviceAuthentication()"
        >Authenticate</a
      >

      <div id="container-redirect-wallet" class="btn custom-btn">
        <a id="link_to_wallet" href="{{ location }}">Go to EUDI Wallet</a>
      </div>

      {% if env_var == "dev" %}
      <div id="dev-div" style="width: 100%; margin-top: 20px">
        <p style="font-weight: bold">Link to EUDI Wallet:</p>
        <p id="result">{{ location }}</p>
        <p id="description" style="font-weight: bold">
          After authorization the wallet will redirect to a link. Introduce link
          redirect to in the input box below.
        </p>
        <input
          type="text"
          id="authLink"
          placeholder="Enter your response here"
        />
        <button
          class="btn sign-custom-btn"
          style="margin-top: 0px"
          id="submitButton"
          onclick="submitButton()"
        >
          Submit Text
        </button>
        <a
          id="link-to-continue"
          class="btn sign-custom-btn"
          style="margin-top: 0px"
          >Continue</a
        >
      </div>
      {% endif %}
    </div>
  </div>
</div>
<script>
  document.getElementById("container-redirect-wallet").hidden = true;
  if ("{{env_var}}" === "dev") {
    document.getElementById("dev-div").hidden = true;
    document.getElementById("link-to-continue").hidden = true;
  }

  async function serviceAuthentication() {
    document.getElementById("container-redirect-wallet").hidden = false;
    if ("{{env_var}}" === "dev") {
      document.getElementById("dev-div").hidden = false;
    }
  }

  async function submitButton() {
    const userInput = document.getElementById("authLink").value;
    document.getElementById("link-to-continue").href = userInput;
    document.getElementById("link-to-continue").hidden = false;
  }
</script>
{% endblock %}
